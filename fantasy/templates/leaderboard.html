{% extends "fantasy.html" %}
{% load humanize %}

{% block fantasy-main %}
<div class="section-header">
    <div class="section-title"><a href="{{ series.get_absolute_url }}">{{ series }}</a></div>
    {% if series.description %}<div class="section-tagline">{{ series.description }}</div>{% endif %}
</div>
<h2>Leaderboard</h2>
<div id="leaderboard-container" class="fantasy-list-container">
{% if points_list %}
    
    <table id="leaderboard-events-table" class="fantasy-list-table">
        <thead>
            <tr>
                <th></th>
                <th></th>
                <th></th>
                <th colspan={{ points_list.0.event_points|length }}>{{ series.event_label }} points</th>
            </tr>
            <tr>
                <th></th>
                <th>Fan</th>
                <th>Total<br />Points</th>
{% for p in points_list.0.event_points %}
                <th><a href="{{ p.key.get_absolute_url }}"><span class="event-header">{{ forloop.counter }}</span></a></th>
{% endfor %}
            </tr>
        </thead>
        <tbody>
{% for u in points_list %}
            <tr>
                <td>{{ forloop.counter }}.</td>
                <td>{{ u.name }}</td>
                <td>{{ u.points }}</td>
{% for p in u.event_points %}
                <td class="event-points">{{ p.val }}</td>
{% endfor %}
            </tr>
{% endfor %}
        </tbody>
    </table>
    
    <table id="leaderboard-places-table" class="fantasy-list-table">
        <thead>
            <tr>
                <th></th>
                <th colspan={{ scoresys_results|length }}># picks for each place</th>
            </tr>
            <tr>
                <th>Fan</th>
{% for place in scoresys_results %}
                <th>{{ place|ordinal }}</th>
{% endfor %}
            </tr>
        </thead>
        <tbody>
{% for u in points_list %}
            <tr>
                <td>{{ u.name }}</td>
{% for p in u.place_totals %}
                <td class="event-points">{{ p.val }}</td>
{% endfor %}
            </tr>
{% endfor %}
        </tbody>
    </table>
{% if late_points_list %}
    
    <table id="leaderboard-events-table" class="fantasy-list-table">
        <thead>
            <tr>
                <th></th>
                <th colspan="2">Late Entry</th>
                <th colspan={{ points_list.0.event_points|length }}>{{ series.event_label }} points</th>
            </tr>
            <tr>
                <th></th>
                <th>Fan</th>
                <th>Total<br />Points</th>
{% for p in late_points_list.0.event_points %}
                <th><a href="{{ p.key.get_absolute_url }}"><span class="event-header">{{ forloop.counter }}</span></a></th>
{% endfor %}
            </tr>
        </thead>
        <tbody>
{% for p in late_points_list %}
            <tr>
                <td>{{ forloop.counter }}.</td>
                <td class="late-entry">* {{ p.name }}</td>
                <td class="late-entry">{{ p.points }}</td>
{% for p in p.event_points %}
                <td class="event-points late-entry">{{ p.val }}</td>
{% endfor %}
            </tr>
{% endfor %}
        </tbody>
    </table>
    <p class="late-entry">* These users entered late guesses. Their points do not count towards the Series standings.</p>
{% endif %}    
{% else %}
No leaders yet!<br /><br />
<h2>Guessers in this Series</h2>
<ul>
{% for u in user_list %}
    <li>{{ u.user }}</li>
{% endfor %}
</ul>
{% endif %}
</div>
<div id="comment-block">
{% with series as comment_obj %}
{% include "comment_block.html" %}
{% endwith %}
</div>
{% endblock %}
